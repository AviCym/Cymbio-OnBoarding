{"version":3,"file":"orders.js","sourceRoot":"","sources":["../../controllers/orders.ts"],"names":[],"mappings":";;;;;;AAAA,iEAAyC;AAEzC,4EAAoD;AACpD,gFAAwD;AAExD,MAAM,YAAY,GAAG,IAAI,gBAAM,CAAC,QAAQ,CAAC,CAAC;AAC1C,MAAM,aAAa,GAAG,IAAI,kBAAQ,CAAC,QAAQ,CAAC,CAAC;AAEtC,MAAM,gBAAgB,GAAG,KAAK,EAAE,GAAW,EAAE,GAAY,EAAE,EAAE;IAChE,IAAI;QACA,MAAM,aAAa,GAAU,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACtD,MAAM,YAAY,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAC7C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACpC,OAAO,CAAC,GAAG,CAAC,OAAO,EAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KACjC;IACD,OAAO,KAAS,EAAE;QACd,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;KACpD;AACL,CAAC,CAAA;AAVY,QAAA,gBAAgB,oBAU5B;AACM,MAAM,iBAAiB,GAAG,KAAK,EAAE,GAAW,EAAE,GAAY,EAAE,EAAE;IAClE,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAA;IAC5C,IAAI;QACA,MAAM,aAAa,GAAG,aAAa,CAAC,YAAY,EAAE,CAAC;QACnD,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACpC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;KAC9B;IACD,OAAO,KAAS,EAAE;QACd,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;KACpD;AACL,CAAC,CAAA;AAVY,QAAA,iBAAiB,qBAU7B;AAEM,MAAM,YAAY,GAAG,KAAK,EAAE,GAAW,EAAE,GAAY,EAAE,EAAE;IAC5D,IAAG;QACD,MAAM,EAAC,EAAE,EAAC,GAAG,GAAG,CAAC,MAAM,CAAC;QACxB,MAAM,KAAK,GAAG,MAAM,gBAAM,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;QAChF,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;KAChB;IAAC,OAAM,GAAG,EAAE;QACX,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QAClB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;KACxB;AACH,CAAC,CAAA;AATU,QAAA,YAAY,gBAStB","sourcesContent":["import Orders from \"../db/models/orders\";\nimport { Request, Response } from \"express\";\nimport Sender from \"../middlewares/rabbitmq/sender\";\nimport Receiver from \"../middlewares/rabbitmq/receiver\";\n\nconst ordersSender = new Sender(\"orders\");\nconst orderReceiver = new Receiver(\"orders\");\n\nexport const pushOrderToQueue = async (req:Request, res:Response) => {\n    try {\n        const receivedOrder:string = JSON.stringify(req.body);\n        await ordersSender.amqpSender(receivedOrder);\n        res.status(201).json(receivedOrder);\n        console.log(\"order\",req.body);\n    }\n    catch (error:any) {\n        res.status(409).json({ message: error.message });\n    }\n}\nexport const getOrderFromQueue = async (req:Request, res:Response) => {\n   console.log('trying to get order from queue')\n    try {\n        const receivedOrder = orderReceiver.amqpReceiver();\n        res.status(201).json(receivedOrder);\n        console.log(receivedOrder);\n    }\n    catch (error:any) {\n        res.status(409).json({ message: error.message });\n    }\n}\n\nexport const getOrderById = async (req:Request, res:Response) => {\n    try{\n      const {id} = req.params;\n      const order = await Orders.query().findById(id).withGraphFetched('order_lines');\n      res.json(order)\n    } catch(err) {\n      console.log(err)\n    res.status(500).json(err)\n    }\n  }"]}